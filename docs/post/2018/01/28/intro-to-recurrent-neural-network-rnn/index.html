<!doctype html><html lang="en-us" class="wf-loading"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="MobileOptimized" content="320"><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="preload" href="https://itsg.dev/js/main.js" as="script"><link rel="preload" href="https://itsg.dev/css/main.css" as="style"><title>Intro to Recurrent Neural Network (RNN)</title><meta name="generator" content="Hugo 0.32.4"><link rel="preconnect" href="https://ajax.googleapis.com/" crossorigin><link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin><meta property="og:title" content="Intro to Recurrent Neural Network (RNN)"><meta property="og:description" content="Recurrent neural networks are able to learn from sequences of data. In this tutorial, we'll learn the concepts behind recurrent networks."><meta property="og:type" content="article"><meta property="og:url" content="https://itsg.dev/post/2018/01/28/intro-to-recurrent-neural-network-rnn/"><meta property="article:published_time" content="2018-01-28T00:00:00+00:00"><meta property="article:modified_time" content="2018-01-28T00:00:00+00:00"><meta property="og:type" content="article"><meta property="og:article:published_time" content="2018-01-28T00:00:00Z"><meta property="og:article:tag" content="rnn"><meta property="og:article:tag" content="deeplearning"><meta name="twitter:card" content="summary"><meta name="twitter:site" content="@megeojoy"><meta name="twitter:creator" content="@megeojoy"><meta name="twitter:title" content="Intro to Recurrent Neural Network (RNN)"><meta name="twitter:description" content="Recurrent neural networks are able to learn from sequences of data. In this tutorial, we'll learn the concepts behind recurrent networks."><meta name="twitter:url" content="https://itsg.dev/post/2018/01/28/intro-to-recurrent-neural-network-rnn/"><meta name="p:domain_verify" content="58lHJFznHgioHOIv2NvLfobc8XEUUZSKm016uFFO4vE"><script type="application/ld+json">{ "@context": "http://schema.org", "@type": "Person", "name": "Geo Joy", "url": "http://geojoy.me", "sameAs": [ "https://twitter.com/megeojoy", "https://www.linkedin.com/in/geojoy/", "https://github.com/Geo-Joy", ], "image": { "@type": "ImageObject", "url": "https://itsg.dev/images/avatar.jpg", "height": 80, "width": 80 } }</script><script type="application/ld+json">{ "@context": "http://schema.org", "@type": "Organization", "@id": "https://itsg.dev", "name": "its Geo", "url": "https://itsg.dev", "logo": { "@type": "ImageObject", "url": "https://itsg.dev/images/avatar.jpg", "height": 80, "width": 80 } }</script><script type="application/ld+json">{ "@context": "http://schema.org", "@type": "WebSite", "url": "https://itsg.dev", "name": "its Geo", "author": { "@type": "Person", "name": "Geo Joy" }, "description": "" }</script><script type="application/ld+json">{ "@context": "http://schema.org", "@type": "BlogPosting", "headline": "Intro to Recurrent Neural Network (RNN)", "description": "Recurrent neural networks are able to learn from sequences of data. In this tutorial, we'll learn the concepts behind recurrent networks.", "author": { "@type": "Person", "name": "Geo Joy" }, "publisher": { "@type": "Organization", "name": "its Geo", "logo": "https://itsg.dev/images/avatar.jpg" }, "image": { "@type": "ImageObject", "url": "https://itsg.dev/images/avatar.jpg", "height": 80, "width": 80 }, "datePublished": "2018-01-28", "dateModified": "2018-01-28", "wordCount": 723 , "keywords": ["rnn","deeplearning"] }</script><style>body {
        margin: 0
    }

    main,
    nav {
        display: block
    }

    a {
        background-color: transparent
    }

    h1 {
        margin: .67em 0;
        font-size: 2em
    }

    img {
        border: 0
    }

    code,
    kbd {
        font-family: monospace, monospace;
        font-size: 1em
    }

    button {
        margin: 0;
        font: inherit;
        color: inherit
    }

    button {
        overflow: visible
    }

    button {
        text-transform: none
    }

    button {
        -webkit-appearance: button
    }

    button::-moz-focus-inner {
        padding: 0;
        border: 0
    }

    * {
        -webkit-box-sizing: border-box;
        box-sizing: border-box
    }

    :after,
    :before {
        -webkit-box-sizing: border-box;
        box-sizing: border-box
    }

    html {
        font-size: 10px
    }

    body {
        font-family: "Raleway", Helvetica, Arial, sans-serif;
        font-size: 14px;
        line-height: 1.42857143;
        color: #333;
        background-color: #000
    }

    button {
        font-family: inherit;
        font-size: inherit;
        line-height: inherit
    }

    a {
        color: #337ab7;
        text-decoration: none
    }

    img {
        vertical-align: middle
    }

    h1,
    h4,
    h5 {
        font-family: inherit;
        font-weight: 500;
        line-height: 1.1;
        color: inherit
    }

    h1 {
        margin-top: 20px;
        margin-bottom: 10px
    }

    h4,
    h5 {
        margin-top: 10px;
        margin-bottom: 10px
    }

    h1 {
        font-size: 36px
    }

    h4 {
        font-size: 18px
    }

    h5 {
        font-size: 14px
    }

    p {
        margin: 0 0 10px
    }

    .text-justify {
        text-align: justify
    }

    ul {
        margin-top: 0;
        margin-bottom: 10px
    }

    blockquote {
        padding: 10px 20px;
        margin: 0 0 20px;
        font-size: 17.5px;
        border-left: 5px solid #000
    }

    blockquote p:last-child {
        margin-bottom: 0
    }

    code,
    kbd {
        font-family: Menlo, Monaco, Consolas, "Courier New", monospace
    }

    code {
        padding: 2px 4px;
        font-size: 90%;
        color: #c7254e;
        background-color: #000;
        border-radius: 4px
    }

    kbd {
        padding: 2px 4px;
        font-size: 90%;
        color: #000;
        background-color: #333;
        border-radius: 3px;
        -webkit-box-shadow: inset 0 -1px 0 rgba(0, 0, 0, .25);
        box-shadow: inset 0 -1px 0 rgba(0, 0, 0, .25)
    }

    .container {
        padding-right: 15px;
        padding-left: 15px;
        margin-right: auto;
        margin-left: auto
    }

    @media (min-width:768px) {
        .container {
            width: 750px
        }
    }

    @media (min-width:992px) {
        .container {
            width: 970px
        }
    }

    @media (min-width:1200px) {
        .container {
            width: 1170px
        }
    }

    .collapse {
        display: none
    }

    .nav {
        padding-left: 0;
        margin-bottom: 0;
        list-style: none
    }

    .nav>li {
        position: relative;
        display: block
    }

    .nav>li>a {
        position: relative;
        display: block;
        padding: 10px 15px
    }

    .navbar {
        position: relative;
        min-height: 50px;
        margin-bottom: 20px;
        border: 1px solid transparent
    }

    @media (min-width:768px) {
        .navbar {
            border-radius: 4px
        }
    }

    @media (min-width:768px) {
        .navbar-header {
            float: left
        }
    }

    .navbar-collapse {
        padding-right: 15px;
        padding-left: 15px;
        overflow-x: visible;
        -webkit-overflow-scrolling: touch;
        border-top: 1px solid transparent;
        -webkit-box-shadow: inset 0 1px 0 rgba(255, 255, 255, .1);
        box-shadow: inset 0 1px 0 rgba(255, 255, 255, .1)
    }

    @media (min-width:768px) {
        .navbar-collapse {
            width: auto;
            border-top: 0;
            -webkit-box-shadow: none;
            box-shadow: none
        }
        .navbar-collapse.collapse {
            display: block !important;
            height: auto !important;
            padding-bottom: 0;
            overflow: visible !important
        }
        .navbar-fixed-top .navbar-collapse {
            padding-right: 0;
            padding-left: 0
        }
    }

    .navbar-fixed-top .navbar-collapse {
        max-height: 340px
    }

    @media (max-device-width:480px) and (orientation:landscape) {
        .navbar-fixed-top .navbar-collapse {
            max-height: 200px
        }
    }

    .container>.navbar-collapse,
    .container>.navbar-header {
        margin-right: -15px;
        margin-left: -15px
    }

    @media (min-width:768px) {
        .container>.navbar-collapse,
        .container>.navbar-header {
            margin-right: 0;
            margin-left: 0
        }
    }

    .navbar-fixed-top {
        position: fixed;
        right: 0;
        left: 0;
        z-index: 1030
    }

    @media (min-width:768px) {
        .navbar-fixed-top {
            border-radius: 0
        }
    }

    .navbar-fixed-top {
        top: 0;
        border-width: 0 0 1px
    }

    .navbar-brand {
        float: left;
        height: 50px;
        padding: 15px 15px;
        font-size: 18px;
        line-height: 20px
    }

    @media (min-width:768px) {
        .navbar>.container .navbar-brand {
            margin-left: -15px
        }
    }

    .navbar-toggle {
        position: relative;
        float: right;
        padding: 9px 10px;
        margin-top: 8px;
        margin-right: 15px;
        margin-bottom: 8px;
        background-color: transparent;
        background-image: none;
        border: 1px solid transparent;
        border-radius: 4px
    }

    .navbar-toggle .icon-bar {
        display: block;
        width: 22px;
        height: 2px;
        border-radius: 1px
    }

    .navbar-toggle .icon-bar+.icon-bar {
        margin-top: 4px
    }

    @media (min-width:768px) {
        .navbar-toggle {
            display: none
        }
    }

    .navbar-nav {
        margin: 7.5px -15px
    }

    .navbar-nav>li>a {
        padding-top: 10px;
        padding-bottom: 10px;
        line-height: 20px
    }

    @media (min-width:768px) {
        .navbar-nav {
            float: left;
            margin: 0
        }
        .navbar-nav>li {
            float: left
        }
        .navbar-nav>li>a {
            padding-top: 15px;
            padding-bottom: 15px
        }
    }

    @media (min-width:768px) {
        .navbar-right {
            float: right !important;
            margin-right: -15px
        }
    }

    .navbar-default {
        background-color: #000;
        border-color: #313131
    }

    .navbar-default .navbar-brand {
        color: #777
    }

    .navbar-default .navbar-nav>li>a {
        color: #ffffffd6
    }

    .navbar-default .navbar-toggle {
        border-color: #ddd
    }

    .navbar-default .navbar-toggle .icon-bar {
        background-color: #888
    }

    .navbar-default .navbar-collapse {
        border-color: #e7e7e7
    }

    .container:after,
    .container:before,
    .nav:after,
    .nav:before,
    .navbar-collapse:after,
    .navbar-collapse:before,
    .navbar-header:after,
    .navbar-header:before,
    .navbar:after,
    .navbar:before {
        display: table;
        content: " "
    }

    .container:after,
    .nav:after,
    .navbar-collapse:after,
    .navbar-header:after,
    .navbar:after {
        clear: both
    }

    @-ms-viewport {
        width: device-width
    }

    .visible-xs {
        display: none !important
    }

    @media (max-width:767px) {
        .visible-xs {
            display: block !important
        }
    }

    html {
        height: 100%
    }

    body {
        height: 100%;
        padding-top: 55px;
        display: -webkit-box;
        display: -ms-flexbox;
        display: flex;
        text-align: center;
        -webkit-box-orient: vertical;
        -webkit-box-direction: normal;
        -ms-flex-direction: column;
        flex-direction: column;
        font-size: 16px !important
    }

    main {
        margin: auto;
        padding: 25px;
        max-width: 750px
    }

    a:link,
    a:visited {
        color: green
    }

    .item {
        padding: 10px 0
    }

    .item-tag {
        background-color: green
    }

    .navbar-icon {
        font-size: 125%;
        display: inline-block !important
    }

    .navbar.navbar-default {
        border-top: 4px solid #08ea08
    }

    img {
        max-width: 100%
    }

    .fade-in {
        opacity: 0
    }

    .wf-loading p,
    .wf-loading h1,
    .wf-loading h2,
    .wf-loading h3,
    .wf-loading h4,
    .wf-loading a {
        visibility: hidden;
    }

    .wf-active p,
    .wf-active h1,
    .wf-active h2,
    .wf-active h3,
    .wf-active h4,
    .wf-active a {
        visibility: visible;
    }

    .wf-inactive p,
    .wf-inactive h1,
    .wf-inactive h2,
    .wf-inactive h3,
    .wf-inactive h4,
    wf-inactive a {
        visibility: visible;
    }</style></head><body bgcolor="#000"><noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KQ3JDPK" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><nav class="navbar navbar-default navbar-fixed-top"><div class="container"><div class="navbar-header"><a class="navbar-brand visible-xs" href="#">geojoy.me</a> <button class="navbar-toggle" data-target=".navbar-collapse" data-toggle="collapse"><span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span></button></div><div class="collapse navbar-collapse"><ul class="nav navbar-nav"><li><a href="/">Home</a></li><li><a href="/post/">Posts</a></li><li><a href="/project/">Projects</a></li></ul><ul class="nav navbar-nav navbar-right"><li class="navbar-icon"><a href="/resume/"><i class="fa fa-user"></i></a></li><li class="navbar-icon"><a href="http://www.google.com/recaptcha/mailhide/d?k=01IIc-s5LNYiS-CG_gthn4PA==&c=r5Ctx8RMDz422qmYESfk1g=="><i class="fa fa-envelope"></i></a></li><li class="navbar-icon"><a href="https://github.com/Geo-Joy"><i class="fa fa-github-alt"></i></a></li><li class="navbar-icon"><a href="https://twitter.com/megeojoy"><i class="fa fa-twitter"></i></a></li><li class="navbar-icon"><a href="https://www.linkedin.com/in/geojoy/"><i class="fa fa-linkedin"></i></a></li></ul></div></div></nav><main class="fade-in"><h4><a itemprop="url" href="/post/2018/01/28/intro-to-recurrent-neural-network-rnn/"><span itemprop="name">Intro to Recurrent Neural Network (RNN)</span></a></h4>January 28, 2018<br><a href="../../../../../tags/rnn"><kbd class="item-tag">rnn</kbd></a> <a href="../../../../../tags/deeplearning"><kbd class="item-tag">deeplearning</kbd></a><br><hr><br><div class="text-justify"><p><img src="/images/articles/2018/RNN/rnn-lstm-intro.jpg" alt="rnn-lstm-intro.jpg" title="rnn-lstm-intro.jpg"> image borrowed from <a href="udacity.com">UDACITY</a></p><p>Recurrent Neural Network is one of the advanced algorithms that existed in the wold of <code>supervised deep learning</code>.</p><h1 id="prelude">Prelude</h1><p>In ANN and CNN we use neural network that takes few inputs, propagates it forward through hidden layers to the output layer. This is termed as a <code>FEED FORWARD NETWORK</code>. In this network there is no sence of order in the inputs.</p><p>OK now lets bring some order to the network.</p><p><br></p><p>Lets take an example data and go forward.</p><pre><code>"STEEP"
</code></pre><p><img src="/images/articles/2018/RNN/feedforward_ex1.png" alt="feedforward_ex1.png" title="feedforward_ex1.png"><center>image borrowed from <a href="udacity.com">UDACITY</a></center></p><p><br>Here <code>x</code> is the input layer <code>h</code> the hidden layer and <code>y</code> the output layer.</p><p>Our goal is to make the network predict the next letter to the sequence.</p><ul><li>First we feed <code>s</code> to the network and our desired output is <code>t</code>.</li><li>Then we feed <code>t</code> to the network and our desired output is <code>e</code>.</li><li>Next we feed the previous <code>e</code> to the network and our desired output should <code>e</code> or <code>p</code>.</li><li>But this feed forward network does not have the information about the which character to predict next as it does not know about the previous letters <code>s</code> <code>t</code> <code>e</code>.</li></ul><p>To include this information in the network we just need to add the previous hidden layer output to the hidden layer in the next step to carry forward the information about the sequence.</p><p>This architecture is know as Recurrent Neural Network or RNN</p><p><img src="/images/articles/2018/RNN/rnn-representation.png" alt="rnn-representation.png" title="rnn-representation.png"><center>image borrowed from <a href="https://www.superdatascience.com">Super Data Science</a></center></p><p>The above image is the standard representation of RNN</p><p><img src="/images/articles/2018/RNN/rnn-representation-time.png" alt="rnn-representation.png" title="rnn-representation.png"><center>image borrowed from <a href="https://www.superdatascience.com">Super Data Science</a></center></p><p>The above image shows RNN expanded in TIME.</p><h1 id="examples-of-rnns">Examples of RNNs</h1><h2 id="one-to-many-relationship">One to Many Relationship</h2><p><img src="/images/articles/2018/RNN/rnn-one-many.png" alt="rnn-one-many.png" title="rnn-one-many.png"><center>image borrowed from <a href="https://www.superdatascience.com">Super Data Science</a></center></p><p><img src="/images/articles/2018/RNN/rnn-one-many-example.png" alt="rnn-one-many.png" title="rnn-one-many.png"><center>image borrowed from <a href="karpathy.github.io">karpathy.github.io</a></center></p><p>Here there is only one input and multiple outputs. For example the image is the input to tht CNN network and then into a RNN then the computer will come up with the word describing the image.</p><p><img src="/images/articles/2018/RNN/rnn-many-one.png" alt="rnn-one-many.png" title="rnn-one-many.png"><center>image borrowed from <a href="https://www.superdatascience.com">Super Data Science</a></center></p><p><img src="/images/articles/2018/RNN/rnn-many-one-example.png" alt="rnn-one-many.png" title="rnn-one-many.png"><center>image borrowed from <a href="dev.havenondemand.com">dev.havenondemand.com</a></center></p><p>Mostly for sentiment analysis from lot of texts like comments etc.</p><p><img src="/images/articles/2018/RNN/rnn-many-many.png" alt="rnn-one-many.png" title="rnn-one-many.png"><center>image borrowed from <a href="https://www.superdatascience.com">Super Data Science</a></center></p><p><img src="/images/articles/2018/RNN/rnn-many-many-example.png" alt="rnn-one-many.png" title="rnn-one-many.png"><center>image borrowed from <a href="https://www.superdatascience.com">Super Data Science</a></center></p><p>Can be used in a translator system. Having reference to genders and tense to reframe the translated text.</p><p><img src="/images/articles/2018/RNN/rnn-many-many2.png" alt="rnn-one-many.png" title="rnn-one-many.png"><center>image borrowed from <a href="https://www.superdatascience.com">Super Data Science</a></center></p><p><img src="/images/articles/2018/RNN/rnn-many-many2-example.png" alt="rnn-one-many.png" title="rnn-one-many.png"><center>image borrowed from <a href="https://www.superdatascience.com">Super Data Science</a></center></p><p>For subtitling movies. Get the information from previous frame to get the context to subtitle other scenes.</p><h1 id="vanishing-gradient">Vanishing Gradient</h1><p>This problem was first discovered by Seph Hochreiter in 1991 later by Joshua Benjio in 1994.</p><p>In Simple words:</p><p>Previously we saw that in the feedback loop through time, we pass in weights to and fro to adjust the cost function as to minimize the gradients. Here randomly assigned weights may be large or small. During forward and backward propagation we are multiplying these weights together. Multipling large weights with each other results in another larger valued weight and multipling smaller weights results in a small value. This make the gradients going through the network really small and vanishing and large causing it to explode. This also causes imbalance in the network where few nodes are trained properly and others very low. Also since these trained information is carried to other nodes over time, the heavily trained nodes are indirectly trained by the information from the less trained node. Which causes erroneous results at the end.</p><p>This is termed as vanishing and exploding gradients or simply Vanishing Gradients.</p><h1 id="solutions-for-vanishing-gradient">Solutions for Vanishing Gradient</h1><p>For Exploding gradient</p><ul><li>Truncated Backpropagation: Here we stop the backpropagation after certain point. (Its not optimal as we are not updating all the weights)</li><li>Penalties: Gradients been penalized and manually reduced</li><li>Gradient Clipping: Max value for gradient</li></ul><p>For Vanishing Gradient</p><ul><li>Weight Initialization: Be smart enought to initial weights to minimize the vanishing gradient problem</li><li>Echo State Networks They some how manage to solve</li><li>Long Short-Term Memory (LSTM)</li></ul><h1 id="lstms-and-its-varients">LSTMs and its Varients</h1><p>One of the best place to understand LSTM is to read the blogpost at <a href="http://colah.github.io/posts/2015-08-Understanding-LSTMs/">http://colah.github.io/posts/2015-08-Understanding-LSTMs/</a></p><p>For My Reference: <img src="/images/articles/2018/RNN/LSTM3-chain.png" alt="LSTM3-chain.png" title="LSTM3-chain.png"><center>image borrowed from <a href="http://colah.github.io">colah.github.io</a></center></p><h2 id="gru-gated-recurrent-network">GRU - Gated Recurrent Network</h2><p><img src="/images/articles/2018/RNN/LSTM3-var-GRU.png" alt="LSTM3-var-GRU.png" title="LSTM3-var-GRU.png"><center>image borrowed from <a href="http://colah.github.io">colah.github.io</a></center></p><h1 id="attentions">Attentions</h1><p>The idea is to let every step of an RNN pick information to look at from some larger collection of information. For example, if you are using an RNN to create a caption describing an image, it might pick a part of the image to look at for every word it outputs.</p></div><h4 class="page-header">Related</h4><div class="item"><h4><a itemprop="url" href="/post/2018/02/03/predicting-stock-price-using-recurrent-neural-network/"><span itemprop="name">Predicting Stock Price using Recurrent Neural Network</span></a></h4>February 3, 2018<h5>A practical implementation of RNN in predicting the stock price.</h5><a href="../../../../../tags/practical"><kbd class="item-tag">practical</kbd></a> <a href="../../../../../tags/rnn"><kbd class="item-tag">rnn</kbd></a> <a href="../../../../../tags/project"><kbd class="item-tag">project</kbd></a></div></main><footer><p class="copyright text-muted">Geo Joy © All rights reserved. Powered by <a href="https://gohugo.io">Hugo</a> and <a href="https://github.com/calintat/minimal">Minimal</a> hosted on <a href="https://github.com/Geo-Joy/geo-joy.github.io">Github</a></p></footer><script async src="https://itsg.dev/js/main.js"></script><script>!function(e,t,a,n,g){e[n]=e[n]||[],e[n].push({"gtm.start":(new Date).getTime(),event:"gtm.js"});var m=t.getElementsByTagName(a)[0],r=t.createElement(a);r.async=!0,r.src="https://www.googletagmanager.com/gtm.js?id=GTM-KQ3JDPK",m.parentNode.insertBefore(r,m)}(window,document,"script","dataLayer")</script></body></html>